<!DOCTYPE html>
<html>
<body>

<h3>Guard Records</h3>

<input id="search" placeholder="Search guard" onkeyup="filter()">

<table border="1" id="tbl"></table>

<script>

let sheet="1CpxpzeEqWKXxTzhnI9nh7WnZdP1jIWIgxkIpS3PBBSc";

fetch("https://docs.google.com/spreadsheets/d/"+sheet+"/gviz/tq?tqx=out:json")
.then(r=>r.text())
.then(t=>{

let j=JSON.parse(t.substr(47).slice(0,-2));
let rows=j.table.rows;

let out="<tr><th>Name</th><th>Location</th><th>Salary</th></tr>";

rows.forEach(x=>{

let n=x.c[0]?.v||"";
let l=x.c[1]?.v||"";
let s=x.c[2]?.v||"";

out+=`<tr>
<td>${n}</td>
<td>${l}</td>
<td>${s}</td>
</tr>`;

});

tbl.innerHTML=out;

});

function filter(){
let v=search.value.toLowerCase();
for(let r of tbl.rows){
r.style.display=r.innerText.toLowerCase().includes(v)?"":"none";
}
}

</script>

</body>
</html>
