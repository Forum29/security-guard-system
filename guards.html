<!DOCTYPE html>
<html>
<head>
<title>Guard Records</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

</head>

<body class="bg-light">

<div class="container mt-4">

<div class="d-flex justify-content-between mb-3">
<h3>Guard Records</h3>
<a href="admin.html" class="btn btn-secondary">Back</a>
</div>

<input id="search" class="form-control mb-3" placeholder="Search guard">

<table class="table table-bordered table-striped" id="tbl">
<thead>
<tr>
<th>Name</th>
<th>Location</th>
<th>Salary</th>
</tr>
</thead>
<tbody></tbody>
</table>

</div>

<script>

if(sessionStorage.role!="admin") location="index.html";

const SHEET_ID="1CpxpzeEqWKXxTzhnI9nh7WnZdP1jIWIgxkIpS3PBBSc";
const SHEET_NAME="Sheet1";

fetch(`https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?sheet=${SHEET_NAME}&tqx=out:json`)
.then(r=>r.text())
.then(t=>{

const json=JSON.parse(t.substring(47).slice(0,-2));
const rows=json.table.rows;

let body="";

rows.forEach(r=>{
let n=r.c[0]?.v||"";
let l=r.c[1]?.v||"";
let s=r.c[2]?.v||"";

if(n)
body+=`<tr>
<td>${n}</td>
<td>${l}</td>
<td>${s}</td>
</tr>`;
});

tbl.querySelector("tbody").innerHTML=body;

});

search.onkeyup=function(){
let v=this.value.toLowerCase();
for(let r of tbl.tBodies[0].rows){
r.style.display=r.innerText.toLowerCase().includes(v)?"":"none";
}
};

</script>

</body>
</html>
