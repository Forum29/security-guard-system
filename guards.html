<!DOCTYPE html>
<html>
<head>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container mt-4">

<h3>Guard Records</h3>

<input id="search" class="form-control mb-3" placeholder="Search guard" onkeyup="filter()">

<table class="table table-bordered table-striped" id="tbl"></table>

</div>

<script>

const sheet="1GcPLcqgyAV23UEQLkQdXUETRAY4dfYlt_6kCG9flYRc";

fetch("https://docs.google.com/spreadsheets/d/"+sheet+"/gviz/tq?tqx=out:json")
.then(r=>r.text())
.then(txt=>{

const json = JSON.parse(txt.substring(47).slice(0,-2));
const rows = json.table.rows;

let html="<tr><th>Name</th><th>Location</th><th>Salary</th></tr>";

rows.forEach(r=>{
let n=r.c[0]?.v||"";
let l=r.c[1]?.v||"";
let s=r.c[2]?.v||"";

if(n){
html+=`<tr><td>${n}</td><td>${l}</td><td>${s}</td></tr>`;
}
});

tbl.innerHTML=html;

});

function filter(){
let v=search.value.toLowerCase();
for(let r of tbl.rows){
r.style.display=r.innerText.toLowerCase().includes(v)?"":"none";
}
}
</script>

</body>
</html>
