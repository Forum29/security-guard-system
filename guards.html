<h3>Guard Records</h3>

<input id="s" placeholder="Search" onkeyup="f()">

<table border="1" id="t"></table>

<script>
let sheet="1emsIaGNpInDbyYvU1DkogECSevK1v-GB9BMkHuMmEP0";

fetch(`https://docs.google.com/spreadsheets/d/${sheet}/gviz/tq?tqx=out:json`)
.then(r=>r.text())
.then(d=>{
let j=JSON.parse(d.substr(47).slice(0,-2));
let h="<tr><th>Name</th><th>Location</th></tr>";

j.table.rows.forEach(r=>{
h+=`<tr><td>${r.c[0].v}</td><td>${r.c[1].v}</td></tr>`;
});

t.innerHTML=h;
});

function f(){
let v=s.value.toLowerCase();
for(let r of t.rows){
r.style.display=r.innerText.toLowerCase().includes(v)?"":"none";
}
</script>

