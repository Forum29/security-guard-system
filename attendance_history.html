<!DOCTYPE html>
<html>
<head>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

<div class="container mt-4">

<h3>Attendance History</h3>

<table class="table table-bordered table-striped" id="tbl"></table>

</div>

<script>

const sheet="1V2-FXC92k7_6eiTvNO296WstgfjeKHSmo02bCVQdmB4";

fetch("https://docs.google.com/spreadsheets/d/"+sheet+"/export?format=csv&gid=327276950")
.then(r=>r.text())
.then(t=>{

let lines=t.trim().split("\n");

let h="<tr><th>Name</th><th>Date</th><th>Day</th><th>Time</th></tr>";

for(let i=1;i<lines.length;i++){

let c=lines[i].split(",");

// c[0] = Timestamp
// c[1] = Name

if(c[1]){

let parts = c[0].split(" ");
let datePart = parts[0].split("/");
let timePart = parts[1];

let d = new Date(
  datePart[2],
  datePart[1]-1,
  datePart[0],
  timePart.split(":")[0],
  timePart.split(":")[1]
);

let date = datePart[0] + "/" + datePart[1] + "/" + datePart[2];
let time = timePart.substring(0,5);
let day = d.toLocaleDateString('en-US',{weekday:'long'});

h+=`<tr><td>${c[1]}</td><td>${date}</td><td>${day}</td><td>${time}</td></tr>`;

}

}

tbl.innerHTML=h;

});

</script>

</body>
</html>
