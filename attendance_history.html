<!DOCTYPE html>
<html>
<body>

<h3>Attendance History</h3>

<table border="1" id="tbl"></table>

<script>

const sheet="1CpxpzeEqWKXxTzhnI9nh7WnZdP1jIWIgxkIpS3PBBSc";

// IMPORTANT: sheet tab name MUST be Attendance
fetch("https://docs.google.com/spreadsheets/d/"+sheet+"/gviz/tq?sheet=Attendance&tq=select%20A,B,C&tqx=out:json")
.then(r=>r.text())
.then(t=>{

const j = JSON.parse(t.substring(47).slice(0,-2));
const rows = j.table.rows;

let h = "<tr><th>Name</th><th>Date</th><th>Time</th></tr>";

// start from index 0 (real data now)
rows.forEach(r=>{

let n = r.c[0] ? r.c[0].v : "";
let d = r.c[1] ? r.c[1].v : "";
let ti = r.c[2] ? r.c[2].v : "";

if(n!=""){   // skip empty rows
h += `<tr>
<td>${n}</td>
<td>${d}</td>
<td>${ti}</td>
</tr>`;
}

});

tbl.innerHTML = h;

});

</script>

</body>
</html>
