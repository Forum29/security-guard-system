<!DOCTYPE html>
<html>
<head>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

<div class="container mt-5">

<div class="card shadow p-4 text-center">

<h4>Mark Attendance</h4>

<input id="box" class="form-control mt-3" placeholder="Enter your name">

<br>

<button onclick="send()" class="btn btn-primary">Mark Attendance</button>

</div>

</div>

<script>

const SCRIPT="https://script.google.com/macros/s/AKfycbx4Ipntd2yCbFNm5sPcVDFbBOvQ9hSR5burFtixrCrkC6x_kUYkUIJQRuKlzHpD_0oLyw/exec";

box.value="";
if(localStorage.guard && localStorage.guard!="undefined"){
box.value=localStorage.guard;
}

let sent=false;

function send(){

if(sent)return;
sent=true;

document.querySelector("button").innerText="Saving...";

fetch(SCRIPT+"?name="+encodeURIComponent(box.value))
.then(r=>r.text())
.then(t=>{
document.body.innerHTML="<h2 class='text-center mt-5'>Done!</h2>";
})
.catch(e=>{
alert("Error connecting to server");
sent=false;
});

}

</script>

</body>
</html>
