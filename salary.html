<!DOCTYPE html>
<html>
<body>

<h3>My Salary</h3>

<table border="1" id="tbl"></table>

<script>

let guard=sessionStorage.guard||"";
let sheet="1CpxpzeEqWKXxTzhnI9nh7WnZdP1jIWIgxkIpS3PBBSc";

fetch("https://docs.google.com/spreadsheets/d/"+sheet+"/gviz/tq?tqx=out:json")
.then(res=>res.text())
.then(txt=>{

let json=JSON.parse(txt.substr(47).slice(0,-2));
let rows=json.table.rows;

let html="<tr><th>Name</th><th>Location</th><th>Salary</th></tr>";

rows.forEach(r=>{

let name=r.c[0]?.v||"";
let loc=r.c[1]?.v||"";
let sal=r.c[2]?.v||"";

if(name.toLowerCase()==guard.toLowerCase()){

html+=`<tr>
<td>${name}</td>
<td>${loc}</td>
<td>${sal}</td>
</tr>`;

}

});

tbl.innerHTML=html;

});

</script>

</body>
</html>
